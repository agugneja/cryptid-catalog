{% extends '_layout.html' %}

{% block title %}Catalog | {{ post.title }}{% endblock %}

{% block body %}
<div class="post">
    <h1>{{ post.title }}</h1><h3>By {{ user.username }}</h3>
    <h3>{{ post.creature }}</h3>
    <!-- form is for going from all posts to encyclopedia entry accosiated creature-->
    <form action="/post_to_entry" method="post">
        <button type="submit" class="btn btn-link creature-btn">
            {{ post.creature }}
        </button>
        <input type="hidden" name="creature" id="creature" value={{post.creature}}>
    </form>
    <div class="centered">
        <img src="\static\forum_post_pictures\{{post.photo_path}}" style="width: 35em; height: auto;">
      </div>
    <p class="mx-5 px-5">{{ post.description }}</p>
    <form action="/comment/{{post.post_id}}" id="algin-form" method="post">
        <div class="form-group mt-5">
            <label for="message">Leave a comment</label>
            <input type="text" class="form-control mt-3" id="message" name="message" placeholder="Enter your comment" required><br>
        </div>
        <div class="mt-2 ml-5">
            <button type="submit" class="btn btn-success">COMMENT</button>
        </div>
    </form>
  {% if session_user_id == user.user_id %}
  <form class="centered mt-3" action="/edit_post/{{ post.post_id }}" method="post">
      <button type="submit" class="btn btn-secondary" style="display: inline;">EDIT POST</button>
  </form>
  <form class="centered" action="/delete_post/{{ post.post_id }}" method="post">
      <button type="submit" class="btn btn-secondary mt-1">DELETE POST</button>
  </form> 
  {% endif %}


{% for comment in comments %}
<div class="comment mt-4 text-justify float-left">
    <h4>{{ comment.user_id }}</h4>
    <p>{{ comment.text }}</p>
    <table>
        <tr>
            <td>
                <form action="/like/{{ post.post_id }}/{{ comment.comment_id }}" method="post">
                    <button type="submit" class="btn btn-success">&#8205; &#8205; &#8205; LIKE &#8205; &#8205; &#8205; </button>
                </form> 
            </td>
            <td>{{ comment.likes }}</td>
            
            <td>
                <form action="/dislike/{{ post.post_id }}/{{ comment.comment_id }}" method="post">
                    <button type="submit" class="btn btn-danger ">DISLIKE</button>
                </form> 
            </td>
            <td>{{ comment.dislikes }}</td>
        </tr>
        {% if session_user_id == comment.user_id %}
          <tr>
            <td>
                <form action="/edit_comment/{{ post.post_id }}/{{ comment.comment_id }}" method="post">
                    <button type="submit" class="btn btn-secondary ">EDIT</button>
                </form>
            </td>
            <td>
                <form action="/delete_comment/{{ post.post_id }}/{{ comment.comment_id }}" method="post">
                    <button type="submit" class="btn btn-secondary ">DELETE</button>
                </form>
            </td>
          </tr>
        {% endif %}
    </table>
</div>
{% endfor %}


{% endblock %}
